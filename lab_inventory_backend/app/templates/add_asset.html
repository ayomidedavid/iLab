{% set current_user = current_user if current_user is defined else session if session is defined else {} %}
<!-- templates/add_asset.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Add Asset â€” iLab</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/static/style.css">
  <style>
    body{background:linear-gradient(135deg,#2c3e50 0%,#3498db 100%);min-height:100vh;color:#fff}
    .card-soft{background:linear-gradient(180deg,rgba(255,255,255,0.04),rgba(255,255,255,0.02));backdrop-filter:blur(6px);border-radius:12px}
    .label{font-weight:600;color:rgba(255,255,255,0.9)}
    .muted{color:rgba(255,255,255,0.75)}
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="d-flex align-items-center mb-3">
          <img src="{{ url_for('static', filename='logo.png') }}" class="logo me-3" alt="iLab" style="width:56px">
          <div>
            <h3 class="mb-0">Add New Asset</h3>
            <div class="muted">Quickly register a new desktop into inventory</div>
          </div>
        </div>

        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <div class="alert alert-success alert-dismissible fade show" role="alert">
              {{ messages[0] }}
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
          {% endif %}
        {% endwith %}
        <div class="card card-soft p-4">
          <form method="post" action="{{ url_for('add_asset') }}">
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label label">UUID / Barcode</label>
                <input name="uuid" class="form-control" placeholder="auto-generated or paste UUID" />
              </div>
              <div class="col-md-6">
                <label class="form-label label">Hostname / Device Name</label>
                <input name="device_name" class="form-control" required />
              </div>

              <div class="col-md-4">
                <label class="form-label label">Manufacturer</label>
                <select name="manufacturer" class="form-select">
                  <option value="HP">HP</option>
                  <option value="Dell">Dell</option>
                  <option value="Lenovo">Lenovo</option>
                  <option value="Apple">Apple</option>
                  <option value="Acer">Acer</option>
                  <option value="Other">Other</option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label label">Model</label>
                <select name="model" class="form-select" id="model-select" onchange="toggleModelInput()">
                  <option value="HP ALL-IN-ONE 24-DF1XXX">HP ALL-IN-ONE 24-DF1XXX</option>
                  <option value="HP PAVILION ALL-IN-ONE 24-XA0XXX">HP PAVILION ALL-IN-ONE 24-XA0XXX</option>
                  <option value="Other">Other</option>
                </select>
                <input name="model_other" id="model-other" class="form-control mt-2" style="display:none" placeholder="Enter model if not listed" />
              </div>
              <div class="col-md-4">
                <label class="form-label label">Serial Number</label>
                <input name="serial_number" class="form-control" />
              </div>

              <div class="col-md-4">
                <label class="form-label label">OS</label>
                <select name="os" class="form-select">
                  <option value="WINDOWS 10">WINDOWS 10</option>
                  <option value="WINDOWS 11">WINDOWS 11</option>
                  <option value="MACOS">MACOS</option>
                  <option value="LINUX">LINUX</option>
                  <option value="OTHER">OTHER</option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label label">CPU</label>
                <select name="cpu" class="form-select" id="cpu-select" onchange="toggleCpuInput()">
                  <option value="CORE i5">CORE i5</option>
                  <option value="Other">Other</option>
                </select>
                <input name="cpu_other" id="cpu-other" class="form-control mt-2" style="display:none" placeholder="Enter CPU if not listed" />
              </div>
              <div class="col-md-4">
                <label class="form-label label">RAM</label>
                <select name="ram" class="form-select" id="ram-select" onchange="toggleRamInput()">
                  <option value="8GB">8GB</option>
                  <option value="Other">Other</option>
                </select>
                <input name="ram_other" id="ram-other" class="form-control mt-2" style="display:none" placeholder="Enter RAM if not listed" />
              </div>

              <div class="col-md-6">
                <label class="form-label label">Storage</label>
                <select name="storage" class="form-select" id="storage-select" onchange="toggleStorageInput()">
                  <option value="256GB">256GB</option>
                  <option value="1TB">1TB</option>
                  <option value="Other">Other</option>
                </select>
                <input name="storage_other" id="storage-other" class="form-control mt-2" style="display:none" placeholder="Enter storage if not listed" />
              </div>

              <div class="col-md-4">
                <label class="form-label label">Mouse Status</label>
                <select name="mouse" class="form-select">
                  <option value="AVAILABLE">AVAILABLE</option>
                  <option value="FAULTY">FAULTY</option>
                  <option value="MISSING">MISSING</option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label label">Keyboard Status</label>
                <select name="keyboard" class="form-select">
                  <option value="AVAILABLE">AVAILABLE</option>
                  <option value="FAULTY">FAULTY</option>
                  <option value="MISSING">MISSING</option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label label">Power Status</label>
                <select name="power_pack" class="form-select">
                  <option value="AVAILABLE">AVAILABLE</option>
                  <option value="FAULTY">FAULTY</option>
                  <option value="MISSING">MISSING</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label label">Location</label>
                <select name="location" class="form-select" id="location-select" onchange="toggleLocationInput()">
                  <option value="SLab">SLab</option>
                  <option value="HLab">HLab</option>
                  <option value="Other">Other</option>
                </select>
                <input name="location_other" id="location-other" class="form-control mt-2" style="display:none" placeholder="Enter location if not listed" />
              </div>

              <div class="col-md-6">
                <label class="form-label label">Status</label>
                <select name="status" class="form-select">
                  <option value="GOOD">GOOD</option>
                  <option value="FAULTY">FAULTY</option>
                  <option value="DECOMMISSIONED">DECOMMISSIONED</option>
                </select>
              </div>


              <div class="col-12 d-flex gap-2 justify-content-end">
                <a href="{% if current_user.role == 'admin' %}/admindashboard{% elif current_user.role == 'technician' %}/techniciandashboard{% elif current_user.role == 'lecturer' %}/lecturerdashboard{% elif current_user.role == 'student' %}/studentdashboard{% else %}/viewonlydashboard{% endif %}" class="btn btn-light">Cancel</a>
                <a href="{% if current_user.role == 'admin' %}/admindashboard{% elif current_user.role == 'technician' %}/techniciandashboard{% elif current_user.role == 'lecturer' %}/lecturerdashboard{% elif current_user.role == 'student' %}/studentdashboard{% else %}/viewonlydashboard{% endif %}" class="btn btn-secondary">Go to Home</a>
                <button class="btn btn-primary" type="submit">Add Asset</button>
              </div>
            </div>
          </form>
        </div>

      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function toggleModelInput() {
      var select = document.getElementById('model-select');
      var input = document.getElementById('model-other');
      input.style.display = select.value === 'Other' ? 'block' : 'none';
    }
    function toggleCpuInput() {
      var select = document.getElementById('cpu-select');
      var input = document.getElementById('cpu-other');
      input.style.display = select.value === 'Other' ? 'block' : 'none';
    }
    function toggleRamInput() {
      var select = document.getElementById('ram-select');
      var input = document.getElementById('ram-other');
      input.style.display = select.value === 'Other' ? 'block' : 'none';
    }
    function toggleLocationInput() {
      var select = document.getElementById('location-select');
      var input = document.getElementById('location-other');
      input.style.display = select.value === 'Other' ? 'block' : 'none';
    }
    function toggleStorageInput() {
      var select = document.getElementById('storage-select');
      var input = document.getElementById('storage-other');
      input.style.display = select.value === 'Other' ? 'block' : 'none';
    }
  </script>
</body>
</html>
